# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ Kimi K2 –∏ Gemini 2.5 Flash

**–î–∞—Ç–∞:** 2025-11-14
**–ê–≤—Ç–æ—Ä:** Claude (AI Assistant)

## üìã –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ

–í—ã–ø–æ–ª–Ω–µ–Ω–æ –º–∞—Å—à—Ç–∞–±–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π –±–æ—Ç–∞ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –∫–∞—á–µ—Å—Ç–≤–∞ —Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏–∏ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π:

1. **–ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ Kimi K2** –∫–∞–∫ –æ—Å–Ω–æ–≤–Ω—É—é –º–æ–¥–µ–ª—å –¥–ª—è —Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏–∏ —Ç–µ–∫—Å—Ç–æ–≤ (–±–µ—Å–ø–ª–∞—Ç–Ω—ã–π —á–µ—Ä–µ–∑ OpenRouter)
2. **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ Gemini Vision** —Å 2.0 –Ω–∞ 2.5 Flash –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
3. **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ EasyOCR** –∫–∞–∫ fallback –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
4. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–∏–∫–∏ –≤—ã–±–æ—Ä–∞ –∫–æ–Ω—Ç–µ–Ω—Ç–∞** –¥–ª—è —Å–º–µ—à–∞–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π

---

## üî• –û—Å–Ω–æ–≤–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### 1. **config.py** - –ù–æ–≤–∞—è –∏–µ—Ä–∞—Ä—Ö–∏—è –º–æ–¥–µ–ª–µ–π

#### –î–æ:
```python
# Primary: Google Gemini
GEMINI_MODEL = 'gemini-2.0-flash-exp'
USE_GEMINI_PRIMARY = True

# Secondary: OpenRouter
OPENROUTER_PRIMARY_MODEL = 'deepseek/deepseek-chat-v3.1:free'
```

#### –ü–æ—Å–ª–µ:
```python
# Primary: Kimi K2 via OpenRouter (256K context, free)
USE_OPENROUTER_PRIMARY = True (default)
OPENROUTER_PRIMARY_MODEL = 'moonshotai/kimi-k2:free'
OPENROUTER_SECONDARY_MODEL = 'deepseek/deepseek-chat-v3.1:free'
OPENROUTER_TERTIARY_MODEL = 'qwen/qwen-2.5-72b-instruct:free'

# Secondary: Gemini 2.5 Flash (vision/multimodal only)
USE_GEMINI_PRIMARY = False (default)
GEMINI_MODEL = 'gemini-2.5-flash'
GEMINI_VISION_MODEL = 'gemini-2.5-flash'
```

### 2. **llm/provider_router.py** - –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Ä–æ—É—Ç–∏–Ω–≥–∞

#### –ù–æ–≤—ã–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –º–æ–¥–µ–ª–µ–π:
1. **Kimi K2** (moonshotai/kimi-k2:free) - –æ—Å–Ω–æ–≤–Ω–∞—è –¥–ª—è —Ç–µ–∫—Å—Ç–æ–≤
2. **DeepSeek V3** (deepseek/deepseek-chat-v3.1:free) - fallback #1
3. **Qwen 2.5 72B** (qwen/qwen-2.5-72b-instruct:free) - fallback #2
4. **Gemini 2.5 Flash** - fallback #3 / –æ—Å–Ω–æ–≤–Ω–∞—è –¥–ª—è vision
5. **Groq Llama 3.1 405B** - —Ñ–∏–Ω–∞–ª—å–Ω—ã–π fallback

#### –£–ª—É—á—à–µ–Ω–Ω—ã–π fallback –º–µ—Ö–∞–Ω–∏–∑–º:
```python
def _switch_to_fallback(self) -> Tuple[Any, str, str]:
    # Kimi K2 ‚Üí DeepSeek V3 ‚Üí Qwen 2.5 ‚Üí Gemini ‚Üí Groq
    # –° –¥–µ—Ç–∞–ª—å–Ω—ã–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º –∫–∞–∂–¥–æ–≥–æ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è
```

#### –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π analyze_image –¥–ª—è Gemini Vision 2.5:
```python
def analyze_image(...):
    # –ò—Å–ø–æ–ª—å–∑—É–µ—Ç GEMINI_VISION_MODEL = 'gemini-2.5-flash'
    # –°–æ–∑–¥–∞–µ—Ç –æ—Ç–¥–µ–ª—å–Ω—ã–π vision_client –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
```

### 3. **ocr/ocr_router.py** - –î–æ–±–∞–≤–ª–µ–Ω EasyOCR

#### –ù–æ–≤–∞—è –∏–µ—Ä–∞—Ä—Ö–∏—è OCR –¥–≤–∏–∂–∫–æ–≤:
1. **EasyOCR** (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç #1, fallback –¥–ª—è Gemini Vision)
2. **PaddleOCR** (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç #2)
3. **Tesseract** (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç #3, last resort)

#### –î–æ–±–∞–≤–ª–µ–Ω—ã –Ω–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã:
```python
def _extract_with_easyocr(self, image_path: str) -> str:
    """Extract text using EasyOCR (primary fallback for Gemini Vision)"""
    # –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ confidence > 0.3
    # –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä—É—Å—Å–∫–æ–≥–æ –∏ –∞–Ω–≥–ª–∏–π—Å–∫–æ–≥–æ —è–∑—ã–∫–æ–≤
    # –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
```

#### –û–±–Ω–æ–≤–ª–µ–Ω get_engine_info():
```python
{
  'easyocr': {
    'available': True/False,
    'enabled': True,  # Always enabled if available
    'initialized': True/False
  }
}
```

### 4. **–õ–æ–≥–∏–∫–∞ –≤—ã–±–æ—Ä–∞ –∫–æ–Ω—Ç–µ–Ω—Ç–∞** - –ü—Ä–æ–≤–µ—Ä–µ–Ω–∞ –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç

‚úÖ –£–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –≤ bot/core/router.py –∏ bot/handlers/choice_handler.py
‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –í–°–ï–ì–î–ê –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –≤—ã–±–æ—Ä –ø—Ä–∏ —Å–º–µ—à–∞–Ω–Ω–æ–º –∫–æ–Ω—Ç–µ–Ω—Ç–µ
‚úÖ –ù–ï –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –µ—Å–ª–∏ –µ—Å—Ç—å –¥—Ä—É–≥–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç

---

## üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π

| –ú–æ–¥–µ–ª—å | –ö–æ–Ω—Ç–µ–∫—Å—Ç | –°–∫–æ—Ä–æ—Å—Ç—å | –°—Ç–æ–∏–º–æ—Å—Ç—å | –ö–∞—á–µ—Å—Ç–≤–æ | –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ |
|--------|----------|----------|-----------|----------|------------|
| **Kimi K2** | 256K | ‚ö°‚ö° –ë—ã—Å—Ç—Ä–æ | FREE | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | –î–ª–∏–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã, –∫–Ω–∏–≥–∏ |
| **DeepSeek V3** | 128K | ‚ö°‚ö° –ë—ã—Å—Ç—Ä–æ | FREE | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | Reasoning, —Å–ª–æ–∂–Ω—ã–µ –∑–∞–¥–∞—á–∏ |
| **Gemini 2.5 Flash** | 2M | ‚ö°‚ö°‚ö° –û—á–µ–Ω—å –±—ã—Å—Ç—Ä–æ | FREE | ‚≠ê‚≠ê‚≠ê‚≠ê | Vision, –º—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω–æ—Å—Ç—å |
| **Qwen 2.5 72B** | 32K | ‚ö°‚ö° –ë—ã—Å—Ç—Ä–æ | FREE | ‚≠ê‚≠ê‚≠ê‚≠ê | –ú—É–ª—å—Ç–∏—è–∑—ã—á–Ω–æ—Å—Ç—å |

---

## üéØ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

### Kimi K2 (–æ—Å–Ω–æ–≤–Ω–∞—è –º–æ–¥–µ–ª—å –¥–ª—è —Ç–µ–∫—Å—Ç–æ–≤):
‚úÖ **256K –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–µ –æ–∫–Ω–æ** - –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ü–µ–ª—ã—Ö –∫–Ω–∏–≥ –±–µ–∑ —á–∞–Ω–∫–∏–Ω–≥–∞
‚úÖ **–ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –¥–æ—Å—Ç—É–ø** —á–µ—Ä–µ–∑ OpenRouter (6 req/min, 3M tokens/–¥–µ–Ω—å)
‚úÖ **–¢–æ–ø performance** –Ω–∞ SWE-bench (71.3%), AIME 2024 (69.6%)
‚úÖ **#1 —Å—Ä–µ–¥–∏ open source –º–æ–¥–µ–ª–µ–π** –Ω–∞ LMSYS Arena

### Gemini 2.5 Flash (–æ–±–Ω–æ–≤–ª–µ–Ω —Å 2.0):
‚úÖ **–ù–∞ 50% –±—ã—Å—Ç—Ä–µ–µ** —á–µ–º Gemini 2.0 Flash
‚úÖ **–ù–∞ 20% –¥–µ—à–µ–≤–ª–µ** ($0.0007 –∑–∞ 1K —Å–∏–º–≤–æ–ª–æ–≤)
‚úÖ **–£–ª—É—á—à–µ–Ω–Ω—ã–µ reasoning —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏**
‚úÖ **–¢–æ—Ç –∂–µ –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π tier** (1M —Ç–æ–∫–µ–Ω–æ–≤/–º–∏–Ω—É—Ç—É)

### EasyOCR (–Ω–æ–≤—ã–π fallback):
‚úÖ **–õ—É—á—à–µ–µ –∫–∞—á–µ—Å—Ç–≤–æ** —á–µ–º Tesseract –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
‚úÖ **80+ —è–∑—ã–∫–æ–≤** (—Ä—É—Å—Å–∫–∏–π + –∞–Ω–≥–ª–∏–π—Å–∫–∏–π –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã)
‚úÖ **GPU –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è** (—Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ CPU)
‚úÖ **Confidence —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è** (>0.3 –¥–ª—è –∫–∞—á–µ—Å—Ç–≤–∞)

---

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:
1. `config.py` - –Ω–æ–≤–∞—è –∏–µ—Ä–∞—Ä—Ö–∏—è –º–æ–¥–µ–ª–µ–π
2. `llm/provider_router.py` - –ª–æ–≥–∏–∫–∞ —Ä–æ—É—Ç–∏–Ω–≥–∞ –∏ fallback
3. `ocr/ocr_router.py` - –¥–æ–±–∞–≤–ª–µ–Ω EasyOCR
4. `KIMI_K2_UPGRADE_SUMMARY.md` - —ç—Ç–æ—Ç —Ñ–∞–π–ª

### –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ:
‚úÖ –°–∏–Ω—Ç–∞–∫—Å–∏—Å –≤—Å–µ—Ö Python —Ñ–∞–π–ª–æ–≤ –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω
‚úÖ –õ–æ–≥–∏–∫–∞ –≤—ã–±–æ—Ä–∞ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç (—Å—É—â–µ—Å—Ç–≤—É—é—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è)
‚úÖ Fallback —Ü–µ–ø–æ—á–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º:
```bash
# –£–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ:
openai  # –î–ª—è OpenRouter
google-generativeai  # –î–ª—è Gemini

# –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ (–¥–ª—è EasyOCR):
pip install easyocr
```

---

## üìù –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –±–æ—Ç–∞:
- **–ù–∏—á–µ–≥–æ –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è!** –ë–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–∞–∫ –∂–µ
- **–£–ª—É—á—à–µ–Ω–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ** —Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏–∏ –¥–ª–∏–Ω–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- **–ë–æ–ª–µ–µ –±—ã—Å—Ç—Ä–∞—è** –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- **–ù–∞–¥–µ–∂–Ω—ã–π fallback** –µ—Å–ª–∏ –æ–¥–Ω–∞ –º–æ–¥–µ–ª—å –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞

### –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞:
1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ EasyOCR (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):
   ```bash
   pip install easyocr
   ```

2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (.env):
   ```bash
   # –û—Å–Ω–æ–≤–Ω—ã–µ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ):
   TELEGRAM_BOT_TOKEN=your_token
   OPENROUTER_API_KEY=your_openrouter_key  # –î–ª—è Kimi K2
   GEMINI_API_KEY=your_gemini_key  # –î–ª—è Vision

   # –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:
   USE_OPENROUTER_PRIMARY=true  # –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é
   OPENROUTER_PRIMARY_MODEL=moonshotai/kimi-k2:free  # –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é
   GEMINI_VISION_MODEL=gemini-2.5-flash  # –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é
   ```

3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞:
   ```bash
   python3 main.py
   ```

---

## üêõ –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

1. **EasyOCR —Ç—Ä–µ–±—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –ø–∞–º—è—Ç–∏** (~500MB) –ø—Ä–∏ –ø–µ—Ä–≤–æ–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
2. **Kimi K2 free tier –æ–≥—Ä–∞–Ω–∏—á–µ–Ω** 6 req/min, 3M tokens/–¥–µ–Ω—å (–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ —Å–ª—É—á–∞–µ–≤)
3. **Gemini 2.5 Flash** –ø–æ–∫–∞ –≤ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–º –¥–æ—Å—Ç—É–ø–µ (stable release –æ–∂–∏–¥–∞–µ—Ç—Å—è)

---

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ —Ä–∞–∑–≤–∏—Ç–∏—è:
1. ‚úÖ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∫–∞—á–µ—Å—Ç–≤–∞ —Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏–∏ —Å Kimi K2
2. ‚úÖ A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–µ–∂–¥—É Kimi K2 –∏ DeepSeek V3
3. ‚úÖ –°–±–æ—Ä –º–µ—Ç—Ä–∏–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ä–∞–∑–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π
4. üîÑ –î–æ–±–∞–≤–∏—Ç—å GOT-OCR 2.0 –∏–ª–∏ Qwen2.5-VL –¥–ª—è –º—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω—ã—Ö –∑–∞–¥–∞—á
5. üîÑ –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —á–∞–Ω–∫–∏–Ω–≥ —Å —É—á–µ—Ç–æ–º 256K –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ Kimi K2

---

## üìö –°—Å—ã–ª–∫–∏

- [Kimi K2 Technical Report](https://moonshotai.github.io/Kimi-K2/)
- [Gemini 2.5 Flash Release](https://developers.googleblog.com/en/start-building-with-gemini-25-flash/)
- [EasyOCR Documentation](https://github.com/JaidedAI/EasyOCR)
- [OpenRouter API Docs](https://openrouter.ai/docs)

---

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –¥–µ–ø–ª–æ—é
**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:** ‚úÖ –°–∏–Ω—Ç–∞–∫—Å–∏—Å –ø—Ä–æ–≤–µ—Ä–µ–Ω
**–ö–æ–º–º–∏—Ç:** ‚è≥ –û–∂–∏–¥–∞–µ—Ç –∫–æ–º–º–∏—Ç–∞
