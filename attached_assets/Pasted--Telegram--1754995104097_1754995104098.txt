–¢—ã ‚Äî –∏–Ω–∂–µ–Ω–µ—Ä, –¥–æ—Ä–∞–±–∞—Ç—ã–≤–∞—é—â–∏–π –º–æ–π Telegram-–±–æ—Ç. –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —É–∂–µ –æ—Ç–∫—Ä—ã—Ç –≤ —Å—Ä–µ–¥–µ. –ù—É–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏—é –∞—É–¥–∏–æ, –ø—Ä–∏–Ω–∏–º–∞—è –∫–∞–∫ –ø–µ—Ä–µ—Å–ª–∞–Ω–Ω—ã–µ –≥–æ–ª–æ—Å–æ–≤—ã–µ/–∞—É–¥–∏–æ, —Ç–∞–∫ –∏ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º —Ñ–∞–π–ª—ã. –ò—Å–ø–æ–ª—å–∑—É–π Python 3.11+. –í –ø—Ä–æ–µ–∫—Ç–µ —É–∂–µ –µ—Å—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏ –∑–∞–≥–æ—Ç–æ–≤–∫–∏, –Ω–æ —á–∞—Å—Ç—å –∫–æ–¥–∞ –∞—É–¥–∏–æ –æ–±—Ä–µ–∑–∞–Ω–∞. –°–¥–µ–ª–∞–π —à–∞–≥–∏ –Ω–∏–∂–µ –≤ —Ç–æ—á–Ω–æ—Å—Ç–∏.
–¶–µ–ª–∏
1. –ü–æ–¥–¥–µ—Ä–∂–∞—Ç—å –∏—Å—Ç–æ—á–Ω–∏–∫–∏ Telegram:
    * message.voice (–≥–æ–ª–æ—Å–æ–≤—ã–µ, OGG/Opus)
    * message.audio (–º—É–∑—ã–∫–∞/–∞—É–¥–∏–æ, MP3/FLAC/WAV/‚Ä¶)
    * message.document (–µ—Å–ª–∏ —ç—Ç–æ –∞—É–¥–∏–æ—Ñ–∞–π–ª, –Ω–∞–ø—Ä–∏–º–µ—Ä M4A/MP3/WAV/OGG/WEBM/FLAC, –∏ –¥–∞–∂–µ application/octet-stream —Å –∞—É–¥–∏–æ-—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ–º)
2. –°–∫–∞—á–∞—Ç—å —Ñ–∞–π–ª —á–µ—Ä–µ–∑ Bot API getFile, –±–µ–∑ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ (–∏—Å–ø–æ–ª—å–∑—É–π aiohttp).
3. –ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞—Ç—å –∞—É–¥–∏–æ –≤ WAV 16kHz mono —á–µ—Ä–µ–∑ ffmpeg (–ø–æ–ª—É—á–∞–π –±–∏–Ω–∞—Ä—å –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ —á–µ—Ä–µ–∑ imageio-ffmpeg, –±–µ–∑ —Å–∏—Å—Ç–µ–º–Ω–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏).
4. –ï—Å–ª–∏ –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å/—Ä–∞–∑–º–µ—Ä –≤–µ–ª–∏–∫ ‚Äî —Ä–µ–∑–∞—Ç—å –Ω–∞ –∫—É—Å–∫–∏ –ø–æ ~10 –º–∏–Ω—É—Ç –∏–ª–∏ –ø–æ —Ä–∞–∑–º–µ—Ä—É ~24 –ú–ë (—á—Ç–æ –Ω–∞—Å—Ç—É–ø–∏—Ç —Ä–∞–Ω—å—à–µ), —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∏—Ä–æ–≤–∞—Ç—å –∫–∞–∂–¥—ã–π –∫—É—Å–æ–∫, –æ–±—ä–µ–¥–∏–Ω—è—Ç—å —Ç–µ–∫—Å—Ç.
5. –¢—Ä–∞–Ω—Å–∫—Ä—ã–±–∏—Ä–æ–≤–∞—Ç—å —á–µ—Ä–µ–∑ Groq Whisper (whisper-large-v3) —Å Python SDK groq. –ö–ª—é—á ‚Äî GROQ_API_KEY –∏–∑ .env.
6. –ü—Ä–æ–≥–æ–Ω—è—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç —á–µ—Ä–µ–∑ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π summarizer (–µ—Å–ª–∏ SmartSummarizer –¥–æ—Å—Ç—É–ø–µ–Ω), –∏–Ω–∞—á–µ fallback: —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–π –∫—Ä–∞—Ç–∫–æ–µ —Å–∞–º–º–∞—Ä–∏ —á–µ—Ä–µ–∑ LLM –º–æ–¥–µ–ª—å Groq (llama-3.1-70b-versatile) —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–µ–π ¬´–∫–æ—Ä–æ—Ç–∫–æ, –ø–æ –ø—É–Ω–∫—Ç–∞–º¬ª.
7. –û—Ç–ø—Ä–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –æ—Ç–≤–µ—Ç (markdown), –ø–æ–∫–∞–∑–∞—Ç—å: ¬´–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å/—Ä–∞–∑–º–µ—Ä¬ª, ¬´—Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–Ω—ã–π —è–∑—ã–∫¬ª (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–æ), –∏ —Å–∞–º–º–∞—Ä–∏.
8. –£–¥–∞–ª—è—Ç—å –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –≤ –ª—é–±–æ–º –∏—Å—Ö–æ–¥–µ.
–û–±–Ω–æ–≤–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
–í —Ñ–∞–π–ª–µ pyproject.toml –¥–æ–±–∞–≤—å/—É–±–µ–¥–∏c—å, —á—Ç–æ –µ—Å—Ç—å:
[project]
dependencies = [
  "pydub>=0.25.1",
  "imageio-ffmpeg>=0.4.9",
  # —É–∂–µ –µ—Å—Ç—å:
  "aiohttp>=3.12.14",
  "python-telegram-bot>=22.2",
  "groq>=0.30.0",
  # –æ—Å—Ç–∞–ª—å–Ω–æ–µ –æ—Å—Ç–∞–≤–∏—Ç—å –∫–∞–∫ –µ—Å—Ç—å
]
–î–∞–ª–µ–µ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ —É—Å—Ç–∞–Ω–æ–≤–∫—É –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –≤ —Å—Ä–µ–¥–µ.
–°–æ–∑–¥–∞–π/–ø–µ—Ä–µ–ø–∏—à–∏ —É—Ç–∏–ª–∏—Ç—É –¥–ª—è FFmpeg
–°–æ–∑–¥–∞–π —Ñ–∞–π–ª utils/ffmpeg.py (–ø–µ—Ä–µ–ø–∏—à–∏, –µ—Å–ª–∏ –µ—Å—Ç—å –æ–±—Ä–µ–∑–∞–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è):
# utils/ffmpeg.py
import os
from imageio_ffmpeg import get_ffmpeg_exe

_FFMPEG_PATH = None

def ensure_ffmpeg() -> str:
    global _FFMPEG_PATH
    if _FFMPEG_PATH and os.path.exists(_FFMPEG_PATH):
        return _FFMPEG_PATH
    path = get_ffmpeg_exe()
    _FFMPEG_PATH = path
    return path
–ü–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–ø–∏—à–∏ audio_processor.py
–°–¥–µ–ª–∞–π –º–æ–¥—É–ª—å –±–µ–∑ ¬´‚Ä¶¬ª, —Å–æ —Å–ª–µ–¥—É—é—â–µ–π –ª–æ–≥–∏–∫–æ–π:
# audio_processor.py
import os
import io
import tempfile
import logging
import asyncio
import aiohttp
import aiofiles
import math
import subprocess
from typing import Dict, Any, Optional, List, Tuple
from pydub import AudioSegment
from groq import Groq
from utils.ffmpeg import ensure_ffmpeg

logger = logging.getLogger(__name__)

SUPPORTED_EXTS = {".ogg", ".oga", ".mp3", ".m4a", ".wav", ".flac", ".webm", ".aac"}

class AudioProcessor:
    def __init__(self, groq_client: Groq, max_file_size_mb: int = 50):
        self.groq = groq_client
        self.max_mb = max_file_size_mb

    async def download_telegram_file(self, file_url: str, dst_path: str) -> None:
        async with aiohttp.ClientSession(timeout=aiohttp.ClientTimeout(total=600)) as session:
            async with session.get(file_url) as resp:
                resp.raise_for_status()
                async with aiofiles.open(dst_path, "wb") as f:
                    async for chunk in resp.content.iter_chunked(8192):
                        await f.write(chunk)

    def _convert_to_wav16k_mono(self, src_path: str, dst_path: str) -> Tuple[float, int]:
        """–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è —á–µ—Ä–µ–∑ ffmpeg + –≤–æ–∑–≤—Ä–∞—Ç (–¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å_—Å–µ–∫, –±–∏—Ç—Ä–µ–π—Ç_–ì—Ü)."""
        ffmpeg = ensure_ffmpeg()
        cmd = [
            ffmpeg, "-y", "-i", src_path,
            "-ac", "1", "-ar", "16000",  # mono 16kHz
            "-vn", dst_path
        ]
        subprocess.run(cmd, check=True, stdout=subprocess.DEVNULL, stderr=subprocess.DEVNULL)
        audio = AudioSegment.from_wav(dst_path)
        duration = len(audio) / 1000.0
        return duration, 16000

    def _split_wav(self, wav_path: str, chunk_secs: int = 600) -> List[str]:
        """–†–µ–∂–µ–º –Ω–∞ –∫—É—Å–∫–∏ –ø–æ chunk_secs —Å–µ–∫—É–Ω–¥, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –ø—É—Ç–∏ –∫ –∫—É—Å–∫–∞–º."""
        audio = AudioSegment.from_wav(wav_path)
        chunks = []
        for i in range(0, len(audio), chunk_secs * 1000):
            chunk = audio[i:i + chunk_secs * 1000]
            out_path = wav_path.replace(".wav", f".part{i//1000:04d}.wav")
            chunk.export(out_path, format="wav", parameters=["-ac", "1", "-ar", "16000"])
            chunks.append(out_path)
        return chunks

    async def transcribe_wav(self, wav_path: str) -> str:
        """–¢—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è –æ–¥–Ω–∏–º –≤—ã–∑–æ–≤–æ–º Groq Whisper –¥–ª—è –æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞."""
        with open(wav_path, "rb") as f:
            res = self.groq.audio.transcriptions.create(
                file=("audio.wav", f, "audio/wav"),
                model="whisper-large-v3",
                response_format="verbose_json",
                temperature=0.0
            )
        # res.text —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–µ–∫—Å—Ç, res.language ‚Äî —è–∑—ã–∫, –µ—Å–ª–∏ verbose_json
        text = getattr(res, "text", "") or ""
        return text.strip()

    async def process_audio_from_telegram(self, file_url: str, filename_hint: str) -> Dict[str, Any]:
        if not filename_hint:
            filename_hint = "audio.ogg"
        _, ext = os.path.splitext(filename_hint.lower())
        if ext not in SUPPORTED_EXTS:
            return {"success": False, "error": f"–ù–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–π —Ñ–æ—Ä–º–∞—Ç: {ext}. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ: {', '.join(sorted(SUPPORTED_EXTS))}"}

        tmp_dir = tempfile.mkdtemp(prefix="tg_audio_")
        original_path = os.path.join(tmp_dir, f"orig{ext or '.bin'}")
        wav_path = os.path.join(tmp_dir, "audio.wav")

        try:
            await self.download_telegram_file(file_url, original_path)

            size_mb = os.path.getsize(original_path) / (1024 * 1024)
            if size_mb > self.max_mb:
                return {"success": False, "error": f"–ê—É–¥–∏–æ —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–µ ({size_mb:.1f}MB), –ª–∏–º–∏—Ç {self.max_mb}MB"}

            # –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –≤ WAV 16kHz mono
            duration, _ = self._convert_to_wav16k_mono(original_path, wav_path)

            # –ï—Å–ª–∏ –¥–ª–∏—Ç–µ–ª—å–Ω–æ–µ ‚Äî —Ä–µ–∂–µ–º –∏ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∏—Ä—É–µ–º –ø–æ –∫—É—Å–∫–∞–º
            chunk_paths = self._split_wav(wav_path, chunk_secs=600) if duration > 620 else [wav_path]

            parts = []
            for cp in chunk_paths:
                text = await self.transcribe_wav(cp)
                if text:
                    parts.append(text)

            if not parts:
                return {"success": False, "error": "–ù–µ —É–¥–∞–ª–æ—Å—å —Ä–∞—Å–ø–æ–∑–Ω–∞—Ç—å —Ä–µ—á—å."}

            transcript = "\n".join(parts)
            return {
                "success": True,
                "transcript": transcript,
                "duration_sec": duration,
                "tmp_dir": tmp_dir
            }
        except Exception as e:
            logger.exception("–û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∞—É–¥–∏–æ")
            return {"success": False, "error": f"–û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∞—É–¥–∏–æ: {e}"}
–î–æ–ø–∏—à–∏/–∏—Å–ø—Ä–∞–≤—å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –≤ simple_bot.py
1. –í –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–µ –±–æ—Ç–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–π AudioProcessor:
from audio_processor import AudioProcessor
# ...
self.audio_processor = AudioProcessor(groq_client=self.groq_client)
1. –î–æ–±–∞–≤—å –æ–±—â–∏–π helper –ø–æ–ª—É—á–µ–Ω–∏—è file_url –ø–æ file_id:
async def _get_file_url(self, file_id: str) -> str:
    # self.bot ‚Äî –∏–Ω—Å—Ç–∞–Ω—Å PTB application.bot
    f = await self.bot.get_file(file_id)
    # telegram file URL –¥–æ—Å—Ç—É–ø–µ–Ω –∫–∞–∫ f.file_path —á–µ—Ä–µ–∑ API telegram
    return f.file_path  # PTB 22.x —É–∂–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç https URL
1. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π —Ö–µ–Ω–¥–ª–µ—Ä—ã (voice, audio, document):‚Ä®–í setup/registration –¥–æ–±–∞–≤—å:
app.add_handler(MessageHandler(filters.VOICE, self.on_voice))
app.add_handler(MessageHandler(filters.AUDIO, self.on_audio))
app.add_handler(MessageHandler(filters.Document.MimeType("audio/") | filters.Document.FileExtension(["ogg","oga","mp3","m4a","wav","flac","webm","aac"]), self.on_audio_document))
1. –†–µ–∞–ª–∏–∑—É–π –º–µ—Ç–æ–¥—ã:
async def on_voice(self, update: Update, context: ContextTypes.DEFAULT_TYPE):
    voice = update.message.voice
    file_id = voice.file_id
    file_url = await self._get_file_url(file_id)
    await self._handle_audio(update, file_url, filename_hint="voice.ogg")

async def on_audio(self, update: Update, context: ContextTypes.DEFAULT_TYPE):
    audio = update.message.audio
    file_id = audio.file_id
    name = (audio.file_name or "audio.mp3")
    file_url = await self._get_file_url(file_id)
    await self._handle_audio(update, file_url, filename_hint=name)

async def on_audio_document(self, update: Update, context: ContextTypes.DEFAULT_TYPE):
    doc = update.message.document
    file_id = doc.file_id
    name = doc.file_name or "audio.bin"
    file_url = await self._get_file_url(file_id)
    await self._handle_audio(update, file_url, filename_hint=name)

async def _handle_audio(self, update: Update, file_url: str, filename_hint: str):
    chat_id = update.message.chat_id
    msg = await update.message.reply_text("üéß –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—é –∞—É–¥–∏–æ‚Ä¶ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É—é –∏ —Ä–∞—Å–ø–æ–∑–Ω–∞—é —Ä–µ—á—å‚Ä¶")
    try:
        result = await self.audio_processor.process_audio_from_telegram(file_url, filename_hint)
        if not result.get("success"):
            await msg.edit_text(f"‚ùå {result.get('error')}")
            return

        transcript = result["transcript"]
        duration = result.get("duration_sec")

        # –ü–æ–ø—Ä–æ–±—É–µ–º —Ç–≤–æ–π SmartSummarizer, –µ—Å–ª–∏ –æ–Ω –µ—Å—Ç—å, –∏–Ω–∞—á–µ —Ñ–æ–ª–ª–±–µ–∫
        summary = None
        if hasattr(self, "smart_summarizer") and self.smart_summarizer:
            summary = await self.smart_summarizer.summarize_text_async(
                text=transcript,
                source_type="audio",
                max_points=8
            )

        if not summary:
            # –§–æ–ª–ª–±–µ–∫ —á–µ—Ä–µ–∑ LLM Groq ‚Äî –∫–æ—Ä–æ—Ç–∫–æ–µ —Å–∞–º–º–∞—Ä–∏ –ø–æ –ø—É–Ω–∫—Ç–∞–º
            prompt = (
                "–°—É–º–º–∏—Ä—É–π —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ —Å—Ç–µ–Ω–æ–≥—Ä–∞–º–º—ã –≥–æ–ª–æ—Å–æ–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è –∫—Ä–∞—Ç–∫–æ, –ø–æ –ø—É–Ω–∫—Ç–∞–º (5‚Äì8 –ø—É–Ω–∫—Ç–æ–≤). "
                "–°–æ—Ö—Ä–∞–Ω—è–π —Ç–æ–ª—å–∫–æ —Ñ–∞–∫—Ç—ã, –¥–µ–π—Å—Ç–≤–∏—è, —Ä–µ—à–µ–Ω–∏—è, –¥–∞—Ç—ã –∏ —Ü–∏—Ñ—Ä—ã.\n\n"
                f"–°–¢–ï–ù–û–ì–†–ê–ú–ú–ê:\n{transcript}"
            )
            resp = self.groq_client.chat.completions.create(
                model="llama-3.1-70b-versatile",
                temperature=0.2,
                messages=[{"role":"user","content": prompt}]
            )
            summary = resp.choices[0].message.content.strip()

        header = f"üéôÔ∏è –ê—É–¥–∏–æ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ ({duration:.0f} —Å–µ–∫).\n\n"
        await msg.edit_text(header + summary, disable_web_page_preview=True)
    except Exception as e:
        await msg.edit_text(f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∞—É–¥–∏–æ: {e}")
–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –µ—Å–ª–∏ —É —Ç–µ–±—è –∫–ª–∞—Å—Å SmartSummarizer –Ω–µ –∏–º–µ–µ—Ç summarize_text_async, –¥–æ–±–∞–≤—å –ø—Ä–æ—Å—Ç–æ–π async –≤—Ä–∞–ø–ø–µ—Ä –Ω–∞–¥ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–º –º–µ—Ç–æ–¥–æ–º, –ª–∏–±–æ –ø—Ä–æ—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–π —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –≤—ã–∑–æ–≤ –≤ asyncio.to_thread.
–ü–æ–¥—á–∏c—Ç—å –∏ –¥–æ–±–µ–π SmartSummarizer (–µ—Å–ª–∏ –≤ —Ñ–∞–π–ª–µ –µ—Å—Ç—å ¬´‚Ä¶¬ª)
–í smart_summarizer.py —É–±–µ—Ä–∏ –æ–±—Ä–µ–∑–∫–∏ ... –∏ –¥–æ–ø–∏—à–∏ –º–µ—Ç–æ–¥ (–∏–ª–∏ –¥–æ–±–∞–≤—å —É–ø—Ä–æ—â—ë–Ω–Ω—ã–π), –Ω–∞–ø—Ä–∏–º–µ—Ä:
# –≤ SmartSummarizer
async def summarize_text_async(self, text: str, source_type: str = "audio", max_points: int = 8) -> str:
    return await asyncio.to_thread(self.summarize_text, text, source_type, max_points)

def summarize_text(self, text: str, source_type: str = "audio", max_points: int = 8) -> str:
    # –µ—Å–ª–∏ —Ö–æ—á–µ—à—å ‚Äî —Ç—É—Ç —Ç–≤–æ—è –ª–æ–≥–∏–∫–∞; –∏–Ω–∞—á–µ —Å–¥–µ–ª–∞–π –ø—Ä–æ–∫—Å–∏ –≤ LLM:
    prompt = (
        f"–°—É–º–º–∏—Ä—É–π {source_type} —Å—Ç–µ–Ω–æ–≥—Ä–∞–º–º—É –∫—Ä–∞—Ç–∫–æ, –ø–æ –ø—É–Ω–∫—Ç–∞–º (–¥–æ {max_points}). "
        "–°—Ñ–æ–∫—É—Å–∏—Ä—É–π—Å—è –Ω–∞ –∫–ª—é—á–µ–≤—ã—Ö —Ä–µ—à–µ–Ω–∏—è—Ö, –∑–∞–¥–∞—á–∞—Ö, —Å—Ä–æ–∫–∞—Ö, —Ü–∏—Ñ—Ä–∞—Ö.\n\n"
        f"–¢–µ–∫—Å—Ç:\n{text}"
    )
    resp = self.groq_client.chat.completions.create(
        model="llama-3.1-70b-versatile",
        temperature=0.2,
        messages=[{"role":"user","content": prompt}]
    )
    return resp.choices[0].message.content.strip()
–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–µ –±–æ—Ç–∞
–£–±–µ–¥–∏—Å—å, —á—Ç–æ –≥–¥–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è Groq client, —Ç–∞–º –∂–µ —Å–æ–∑–¥–∞–µ—Ç—Å—è SmartSummarizer –∏ AudioProcessor:
from groq import Groq
from smart_summarizer import SmartSummarizer
from audio_processor import AudioProcessor

self.groq_client = Groq(api_key=os.getenv("GROQ_API_KEY"))
self.smart_summarizer = SmartSummarizer(groq_client=self.groq_client)
self.audio_processor = AudioProcessor(groq_client=self.groq_client)
ENV
–í .env —É–∂–µ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å:
GROQ_API_KEY=...
–ï—Å–ª–∏ –Ω–µ—Ç ‚Äî –¥–æ–±–∞–≤—å.
UX –∏ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö
* –ï—Å–ª–∏ —Ñ–æ—Ä–º–∞—Ç –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è ‚Äî –æ—Ç–≤–µ—á–∞–π: —Å–ø–∏—Å–æ–∫ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã—Ö.
* –ï—Å–ª–∏ —Ñ–∞–π–ª –±–æ–ª—å—à–µ –ª–∏–º–∏—Ç–∞ ‚Äî —Å–æ–æ–±—â–∏ —Ä–µ–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –∏ –ª–∏–º–∏—Ç.
* –ï—Å–ª–∏ —Ä–∞—Å–ø–æ–∑–Ω–∞—Ç—å –Ω–µ —É–¥–∞–ª–æ—Å—å ‚Äî –≤–µ—Ä–Ω–∏ –ø–æ–Ω—è—Ç–Ω–æ–µ ¬´–ù–µ —É–¥–∞–ª–æ—Å—å —Ä–∞—Å–ø–æ–∑–Ω–∞—Ç—å —Ä–µ—á—å¬ª.
–¢–µ—Å—Ç—ã (–±—ã—Å—Ç—Ä—ã–µ —Ä—É—á–Ω—ã–µ)
1. –û—Ç–ø—Ä–∞–≤—å –±–æ—Ç—É voice (OGG/Opus) ‚Äî –¥–æ–ª–∂–µ–Ω –ø—Ä–∏–π—Ç–∏ —Ç–µ–∫—Å—Ç –∏ —Å–∞–º–º–∞—Ä–∏.
2. –û—Ç–ø—Ä–∞–≤—å audio.mp3 (–º—É–∑—ã–∫–∞/–¥–∏–∫—Ç–æ—Ñ–æ–Ω) ‚Äî —Ç–æ –∂–µ.
3. –û—Ç–ø—Ä–∞–≤—å document —Å m4a/wav/flac ‚Äî —Ç–æ –∂–µ.
4. –ü—Ä–æ–≤–µ—Ä—å –¥–ª–∏–Ω–Ω—ã–π —Ñ–∞–π–ª (–±–æ–ª–µ–µ 10 –º–∏–Ω) ‚Äî –ø–æ—Å–º–æ—Ç—Ä–∏, —á—Ç–æ –æ–Ω —Ä–µ–∂–µ—Ç—Å—è –∏ —Å—É–º–º–∏—Ä—É–µ—Ç—Å—è.
5. –ü—Ä–æ–≤–µ—Ä—å —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö: –æ—Ç–ø—Ä–∞–≤—å —Ñ–∞–π–ª > –ª–∏–º–∏—Ç–∞, –ª–∏–±–æ –Ω–µ-–∞—É–¥–∏–æ.
–í–∞–∂–Ω–æ
* –ù–µ —Ç—Ä–æ–≥–∞–π –æ—Å—Ç–∞–ª—å–Ω—É—é –ª–æ–≥–∏–∫—É –±–æ—Ç–∞.
* –°–ª–µ–¥–∏, —á—Ç–æ–±—ã –≤—Å–µ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã/–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ —É–¥–∞–ª—è–ª–∏—Å—å —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ –æ—Ç–≤–µ—Ç–∞ (–º–æ–∂–µ—à—å —á–∏—Å—Ç–∏—Ç—å –≤–Ω—É—Ç—Ä–∏ AudioProcessor –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è).
* –ù–µ –¥–æ–±–∞–≤–ª—è–π –±–ª–æ–∫–∏—Ä—É—é—â–∏–µ I/O –≤ async-–∫–æ–¥ –±–µ–∑ to_thread().
–°–¥–µ–ª–∞–π –≤—Å–µ –ø—Ä–∞–≤–∫–∏, –∑–∞–ø—É—Å—Ç–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –∏ —Å–æ–æ–±—â–∏ –≤ –∫–æ–Ω—Å–æ–ª—å –ª–æ–≥–∞—Ö, —á—Ç–æ –∞—É–¥–∏–æ-—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –∞–∫—Ç–∏–≤–Ω–∞:‚Ä®logger.info("Audio summarization is enabled").
